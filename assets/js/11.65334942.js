(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{399:function(s,t,a){"use strict";a.r(t);var e=a(52),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"本地部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地部署"}},[s._v("#")]),s._v(" 本地部署")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("本教程将默认你会使用Git、Python、Linux等工具~"),a("br"),s._v("\n🖐️会者不难"),a("br"),s._v("\n使用Python 版本不低于"),a("strong",[s._v("3.6")])])]),s._v(" "),a("h2",{attrs:{id:"_1-1-克隆本项目至本地并进入目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-克隆本项目至本地并进入目录"}},[s._v("#")]),s._v(" 1.1 克隆本项目至本地并进入目录")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/XiaoMiku01/bili-live-heart.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" bili-live-heart\n")])])]),a("h2",{attrs:{id:"_1-2-安装所需模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装所需模块"}},[s._v("#")]),s._v(" 1.2 安装所需模块")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r requirements.txt\n")])])]),a("h2",{attrs:{id:"_1-3-配置用户信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-配置用户信息"}},[s._v("#")]),s._v(" 1.3 配置用户信息")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" user.toml\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[users]] # 账号1\n# B站cookie(不要忘记双引号)\ncookie = ""\n# 需要自动打卡主播uid(不是房间号！是UID! 如果为0则只进行签到不赠送小心心 只能填一个)\nruid = 0\n\n[[users]] # 账号2\ncookie =""\nruid = 0\n\n# 多账号请以相同格式添加\n\n[cron] # Cron 表达式(五位数）\ncron = ""\n\n[serverchan] # Server酱sendkey(微信推送，选填)\nsendkey = ""\n')])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("cron 默认为 0 0 * * * 即每天0点0分运行"),a("br"),s._v("\n补充：五位数Cron表达式，第一位表示分，第二位表示时，后三位本项目用不到不解释，例如："),a("br"),s._v(" "),a("code",[s._v("10 0 * * *")]),s._v(" 表示每天0点10分运行"),a("br"),s._v(" "),a("code",[s._v("30 8 * * *")]),s._v(" 表示每天8点30分运行"),a("br"),s._v(" "),a("code",[s._v("50 20 * * *")]),s._v(" 表示每天20点50分运行")])]),s._v(" "),a("h2",{attrs:{id:"_1-4-运行脚本文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-运行脚本文件"}},[s._v("#")]),s._v(" 1.4 运行脚本文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("python3 index.py\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("本项目内置定时模块，并且默认在首次运行时执行一次，之后只需程序后台保持运行即可，可以使用screen tmux 等工具保持后台运行")])]),s._v(" "),a("h2",{attrs:{id:"_1-5-本地更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-本地更新"}},[s._v("#")]),s._v(" 1.5 本地更新")]),s._v(" "),a("p",[s._v("本地更新：命令行直接运行命令拉取最新仓库即可")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git fetch origin master //从远程主机的master分支拉取最新内容 \ngit merge FETCH_HEAD    //将拉取下来的最新内容合并到当前所在的分支中\n")])])]),a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("h2",{attrs:{id:"_2-1-拉取docker镜像至本地"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-拉取docker镜像至本地"}},[s._v("#")]),s._v(" 2.1 拉取Docker镜像至本地")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull xiaomiku01/bili-live-heart\n")])])]),a("h2",{attrs:{id:"_2-2-配置用户信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-配置用户信息"}},[s._v("#")]),s._v(" 2.2 配置用户信息")]),s._v(" "),a("p",[s._v("创建文件env.list，具体内容参考本地部署的部分")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# B站cookie\nCOOKIE=""\n# 需要自动打卡主播uid\nRUID=0\n# Cron 表达式\nCRON="0 0 * * *"\n# Server酱sendkey，选填\nSERVER_CHAN_SENDKEY=""\n')])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("在docker模式下不支持多用户，可以通过并行启动多个容器来达到多用户的目的")])]),s._v(" "),a("h2",{attrs:{id:"_2-3-创建并运行容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-创建并运行容器"}},[s._v("#")]),s._v(" 2.3 创建并运行容器")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -name bili-live-heart1 --env-file env.list xiaomiku01/bili-live-heart\n")])])]),a("p",[s._v("如果不希望创建env.list文件，此处也可以把用户配置直接写在命令里")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -name bili-live-heart1 -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("COOKIE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CRON")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0 0 * * *"')]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVER_CHAN_SENDKEY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" xiaomiku01/bili-live-heart\n")])])]),a("h2",{attrs:{id:"_2-4-本地更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-本地更新"}},[s._v("#")]),s._v(" 2.4 本地更新")]),s._v(" "),a("p",[s._v("docker本身没有更新机制，更新容器需要停止并删除容器，重新拉取镜像并重建容器")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop bili-live-heart1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" bili-live-heart1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull xiaomiku01/bili-live-heart\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -name bili-live-heart1 --env-file env.list xiaomiku01/bili-live-heart\n")])])]),a("p",[s._v("不过这里也可以讨个巧，在docker运行中进入容器中通过git更新代码，然后重启容器，虽然也比较麻烦，但似乎要好一点")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it -w /app/bili-live-heart bili-live-heart1 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" pull\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart bili-live-heart1\n")])])]),a("h2",{attrs:{id:"_2-5-docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-docker-compose"}},[s._v("#")]),s._v(" 2.5 docker-compose")]),s._v(" "),a("p",[s._v("docker-compose是一个用于创建和管理docker容器的工具，可以把docker容器创建和管理分离开来，方便管理\n"),a("a",{attrs:{href:"https://hub.docker.com/r/gxggxl/bili-live-heart",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker images"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[s._v("Running\ndocker-compose.yml")])]),s._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("bili-live-heart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gxggxl/bili"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("live"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("heart\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bili"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("live"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("heart\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("limits")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cpus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0.2'")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 128M\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env_file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./env.list\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n")])])]),a("p",[s._v("env.lsit")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# B站cookie\nCOOKIE=""\n# 需要自动打卡主播uid\nRUID=0\n# Cron 表达式\nCRON="11 20 * * *"\n# Server酱sendkey，选填\nSERVER_CHAN_SENDKEY=""\n# telegram_bot 推送\nSERVER_CHAN_TG_USER_ID=""\nSERVER_CHAN_TG_TOKEN=""\nSERVER_CHAN_TG_PROXY_URL=""\n')])])]),a("p",[s._v("command:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" -f docker-compose.yml up -d\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建目录bili-live-heart 并下载 docker-compose.yml env.list")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/bili-live-heart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/bili-live-heart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://git.gxggxl.workers.dev/https://raw.githubusercontent.com/gxusb/bili-live-heart/master/docker/docker-compose.yml "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://git.gxggxl.workers.dev/https://raw.githubusercontent.com/gxusb/bili-live-heart/master/docker/env.list\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);